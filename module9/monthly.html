<!DOCTYPE html>
<html lang="ru" class="lang-ru">
<head>
  <meta charset="UTF-8">
  <title>Aylıq hesabat / Месячный отчёт</title>
  <style>
    body {
      font-family: system-ui, -apple-system, BlinkMacSystemFont,"Segoe UI",sans-serif;
      margin: 0;
      padding: 0;
      background: #f4f6fb;
      color: #222;
    }
    .page {
      max-width: 1100px;
      margin: 20px auto 40px;
      padding: 20px;
      background: #fff;
      border-radius: 16px;
      box-shadow: 0 10px 25px rgba(0,0,0,0.08);
      position: relative;
    }
    h1 { text-align:center; margin-bottom:6px; }
    .sub { text-align:center; color:#666; font-size:13px; margin-bottom:18px; }
    .lang-switcher { position:absolute; top:14px; right:18px; display:flex; gap:4px; }
    .lang-btn { border:none; padding:4px 10px; border-radius:999px; font-size:11px; cursor:pointer; background:#edf1ff; }
    .lang-btn.active { background:#316cff; color:#fff; box-shadow:0 0 10px rgba(49,108,255,0.6);}
    .period-row,.top-row { display:flex; flex-wrap:wrap; gap:12px; justify-content:center; margin-bottom:15px; }
    .field { display:flex; flex-direction:column; gap:4px; flex:1 1 220px; }
    label { font-size:13px; }
    input,textarea {
      padding:7px 9px; border:1px solid #ccd5f0; border-radius:8px; font-size:13px;
    }
    textarea { min-height:60px; resize:vertical; }
    .role-grid { display:grid; grid-template-columns:repeat(auto-fit,minmax(190px,1fr)); gap:10px; margin-bottom:18px; }
    .role-card { padding:10px; border:1px solid #d0d7ed; border-radius:12px; background:#f7f8ff; cursor:pointer; text-align:center; }
    .role-card.active { background:#316cff; color:#fff; }
    .form-section { display:none; padding:15px; border:1px solid #d0d7ed; border-radius:12px; background:#f9fbff; margin-bottom:15px; }
    .form-section.active { display:block; }
    .btn-primary { padding:9px 20px; border:none; border-radius:999px; background:#316cff; color:#fff; font-weight:600; cursor:pointer; }
    .status { margin-top:10px; font-size:12px; }
    .status.ok { color:green; }
    .status.err { color:red; }

    .t-ru { display:inline; }
    .t-az { display:none; }
    .lang-az .t-ru { display:none; }
    .lang-az .t-az { display:inline; }
  </style>
</head>
<body>
<div class="page">

<div class="lang-switcher">
  <button class="lang-btn active" data-lang="ru">RU</button>
  <button class="lang-btn" data-lang="az">AZ</button>
</div>

<h1>
  <span class="t-az">Aylıq hesabat</span>
  <span class="t-ru">Месячный отчёт</span>
</h1>
<div class="sub">
  <span class="t-az">Ay üzrə yekun nəticələri daxil edin.</span>
  <span class="t-ru">Внесите итоги за месяц.</span>
</div>

<div class="period-row">
  <div class="field">
    <label>MƏSƏLƏN / Месяц</label>
    <input type="month" id="monthVal">
  </div>
</div>

<div class="top-row">
  <div class="field">
    <label>Ad, soyad / ФИО</label>
    <input type="text" id="employeeName">
  </div>
  <div class="field">
    <label>Şöbə / Отдел</label>
    <input type="text" id="department">
  </div>
</div>

<div class="role-grid">
  <div class="role-card active" data-role="director">Direktor</div>
  <div class="role-card" data-role="sales">Satış / Продажи</div>
  <div class="role-card" data-role="service">Servis</div>
  <div class="role-card" data-role="office">Ofis</div>
  <div class="role-card" data-role="smm">SMM</div>
  <div class="role-card" data-role="marketing">Marketinq</div>
  <div class="role-card" data-role="accountant">Mühasib</div>
</div>

<!-- DIRECTOR -->
<div id="form-director" class="form-section active">
  <h3>Direktor</h3>
  <textarea id="dir_summary" placeholder="Годовые итоги, рост, проблемы / Ümumi yekunlar, artım, problemlər"></textarea>
</div>

<!-- SALES -->
<div id="form-sales" class="form-section">
  <h3>Satış / Продажи</h3>
  <input id="sales_turnover" type="number" placeholder="Оборот / Dövriyyə (AZN)">
  <input id="sales_deals" type="number" placeholder="Сделки / Müqavilələr">
</div>

<!-- SERVICE -->
<div id="form-service" class="form-section">
  <h3>Servis</h3>
  <input id="service_income" type="number" placeholder="Доход сервиса (AZN) / Servis gəliri">
  <input id="service_orders" type="number" placeholder="Заявки / Müraciətlər">
</div>

<!-- OFFICE -->
<div id="form-office" class="form-section">
  <h3>Ofis</h3>
  <textarea id="office_quality" placeholder="Качество заявок / Qeydiyyat keyfiyyəti"></textarea>
</div>

<!-- SMM -->
<div id="form-smm" class="form-section">
  <h3>SMM</h3>
  <input id="smm_leads" type="number" placeholder="Лиды / Müraciətlər">
</div>

<!-- MARKETING -->
<div id="form-marketing" class="form-section">
  <h3>Marketinq</h3>
  <input id="mkt_budget" type="number" placeholder="Бюджет / Büdcə (AZN)">
  <input id="mkt_cpl" type="number" placeholder="CPL / Lead dəyəri">
</div>

<!-- ACCOUNTANT -->
<div id="form-accountant" class="form-section">
  <h3>Mühasib</h3>
  <input id="acc_profit" type="number" placeholder="Прибыль / Mənfəət (AZN)">
  <input id="acc_debt" type="number" placeholder="Дебиторка / Debitor borc (AZN)">
</div>

<button class="btn-primary" id="submitBtn">Göndər / Отправить</button>
<div class="status" id="status"></div>

</div>

<script>
const GOOGLE_SCRIPT_URL = "https://script.google.com/macros/s/AKfycbyrb3vA5bb_5tzJXJTzihRbrS-6e415-MwEhro3jPMvpEMJC-BCxqP5E2ESTq8Rkp3g/exec";

const langBtns = document.querySelectorAll(".lang-btn");
const root = document.documentElement;
langBtns.forEach(b=>{
  b.onclick=()=>{ 
    langBtns.forEach(x=>x.classList.remove("active"));
    b.classList.add("active");
    root.className = b.dataset.lang==="az"?"lang-az":"lang-ru";
  }
});

let role="director";
document.querySelectorAll(".role-card").forEach(card=>{
  card.onclick=()=>{
    document.querySelectorAll(".role-card").forEach(c=>c.classList.remove("active"));
    card.classList.add("active");
    role=card.dataset.role;
    document.querySelectorAll(".form-section").forEach(s=>s.classList.remove("active"));
    document.getElementById("form-"+role).classList.add("active");
  }
});

document.getElementById("submitBtn").onclick=()=>{
  const payload={
    periodType:"month",
    month:document.getElementById("monthVal").value,
    employee:document.getElementById("employeeName").value,
    department:document.getElementById("department").value,
    role:role,
    language:root.className==="lang-az"?"AZ":"RU",
    dataJSON:JSON.stringify({role:role,
      director:document.getElementById("dir_summary").value,
      sales_turnover:document.getElementById("sales_turnover")?.value||"",
      sales_deals:document.getElementById("sales_deals")?.value||"",
      service_income:document.getElementById("service_income")?.value||"",
      service_orders:document.getElementById("service_orders")?.value||"",
      office_quality:document.getElementById("office_quality")?.value||"",
      smm_leads:document.getElementById("smm_leads")?.value||"",
      mkt_budget:document.getElementById("mkt_budget")?.value||"",
      mkt_cpl:document.getElementById("mkt_cpl")?.value||"",
      acc_profit:document.getElementById("acc_profit")?.value||"",
      acc_debt:document.getElementById("acc_debt")?.value||""
    })
  };
  fetch(GOOGLE_SCRIPT_URL,{method:"POST",mode:"no-cors",body:JSON.stringify(payload)});
  document.getElementById("status").innerText="OK";
}
</script>
</body>
</html>
