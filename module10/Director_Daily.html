<!DOCTYPE html>
<html lang="az">
<head>
<meta charset="UTF-8">
<title>Director Daily</title>
<style>
body{background:#F4F7FB;font-family:Arial;margin:0;padding:0}
.wrap{max-width:560px;margin:30px auto;padding:25px;background:#fff;border-radius:16px;
box-shadow:0 4px 12px rgba(0,0,0,0.08);border-left:6px solid #0057B7}
.lang{text-align:right;margin-bottom:10px}
.lang button{background:#0057B7;color:#fff;border:none;padding:6px 12px;margin-left:5px;
border-radius:6px;cursor:pointer;font-size:13px}
.lang button.active{background:#003F8A}
h2{color:#12345B;margin-bottom:15px}
label{font-weight:600;font-size:14px;margin-top:10px;display:block}
input,textarea{width:100%;padding:8px 10px;margin-top:4px;margin-bottom:10px;
border-radius:8px;border:1px solid #C9D4E0;box-sizing:border-box}
button.save{margin-top:15px;width:100%;padding:12px;background:#0057B7;color:#fff;
border:none;border-radius:8px;font-size:16px;font-weight:bold;cursor:pointer}
button.save:hover{background:#003F8A}
#status.success{color:green;font-weight:bold}
#status.error{color:red;font-weight:bold}
</style>
</head>
<body>
<div class="wrap">
  <div class="lang">
    <button id="dAZ" class="active">AZ</button>
    <button id="dRU">RU</button>
  </div>

  <h2 id="dTitle">Direktor — gündəlik icmal</h2>

  <form id="directorForm">
    <input type="hidden" name="department" value="Director_Daily">
    <input type="hidden" name="language" id="dLang" value="AZ">

    <label id="dLblDate">Tarix:</label>
    <input type="date" name="date" required>

    <label id="dLblName">Ad:</label>
    <input type="text" name="employee" required>

    <label id="dLblEBITDA">EBITDA (%) — gün üçün qiymətləndirmə:</label>
    <input type="number" name="ebitda" step="0.01">

    <label id="dLblGrowth">Artım tempi, % — keçən ilə nisbətən:</label>
    <input type="number" name="growth" step="0.01">

    <label id="dLblServiceShare">Servis gəlirlərinin dövriyyədə payı (%):</label>
    <input type="number" name="service_share" step="0.01">

    <label id="dLblDeptExec">Şöbələrin plan icrası, %:</label>
    <input type="number" name="dept_exec" step="0.01">

    <label id="dLblSysImp">Gündəlik sistem dəyişikliyi (ədəd):</label>
    <input type="number" name="system_improvements" step="1" min="0">

    <label id="dLblComment">Direktor şərhi:</label>
    <textarea name="comment" rows="3"></textarea>

    <button type="submit" class="save" id="dBtnSave">Saxla</button>
  </form>

  <p id="status"></p>
</div>

<script>
const D_AZ = {
  title:"Direktor — gündəlik icmal",
  date:"Tarix:",
  name:"Ad:",
  ebitda:"EBITDA (%) — gün üçün qiymətləndirmə:",
  growth:"Artım tempi, % — keçən ilə nisbətən:",
  share:"Servis gəlirlərinin dövriyyədə payı (%):",
  dept:"Şöbələrin plan icrası, %:",
  imp:"Gündəlik sistem dəyişikliyi (ədəd):",
  comment:"Direktor şərhi:",
  save:"Saxla"
};
const D_RU = {
  title:"Director — ежедневный обзор",
  date:"Дата:",
  name:"Имя:",
  ebitda:"EBITDA (%) — оценка на день:",
  growth:"Рост к прошлому году, %:",
  share:"Доля сервисных доходов в обороте (%):",
  dept:"Выполнение планов отделов (%):",
  imp:"Количество системных улучшений за день:",
  comment:"Комментарий директора:",
  save:"Сохранить"
};
function dSet(lang){
  const t = lang==="AZ"?D_AZ:D_RU;
  dLang.value=lang;
  dTitle.textContent=t.title;
  dLblDate.textContent=t.date;
  dLblName.textContent=t.name;
  dLblEBITDA.textContent=t.ebitda;
  dLblGrowth.textContent=t.growth;
  dLblServiceShare.textContent=t.share;
  dLblDeptExec.textContent=t.dept;
  dLblSysImp.textContent=t.imp;
  dLblComment.textContent=t.comment;
  dBtnSave.textContent=t.save;
  dAZ.classList.toggle("active",lang==="AZ");
  dRU.classList.toggle("active",lang==="RU");
}
dAZ.onclick=()=>dSet("AZ");
dRU.onclick=()=>dSet("RU");

document.getElementById("directorForm").addEventListener("submit", async e=>{
  e.preventDefault();
  const formData = new FormData(e.target);
  const data = Object.fromEntries(formData.entries());
  ["ebitda","growth","service_share","dept_exec","system_improvements"]
    .forEach(k=>data[k]=Number(data[k]||0));
  const s = document.getElementById("status");
  try{
    await fetch("https://script.google.com/macros/s/AKfycbwZIP6pGEzSFJBe_yNmQOkFlPQu7f9ycRjguVC9WY-O1YwU0oPAV4NR_B7zBEUqW1W9/exec",{
      method:"POST",mode:"no-cors",body:JSON.stringify(data)
    });
    s.textContent="✔ Yadda saxlanıldı / Сохранено";
    s.className="success";
    e.target.reset();
  }catch(err){
    s.textContent="❌ Xəta / Ошибка";
    s.className="error";
  }
});
</script>
</body>
</html>
