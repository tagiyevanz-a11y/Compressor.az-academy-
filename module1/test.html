<div class="kpi-container">
  <h2>Ежедневный отчёт + KPI (Compressor.az)</h2>

  <form id="reportForm">
    <label>Дата:</label>
    <input type="date" name="date" required>

    <label>Сотрудник:</label>
    <input type="text" name="employee" required>

    <label>Отдел:</label>
    <select name="department" required>
      <option>Sales</option>
      <option>Service</option>
      <option>Marketing</option>
      <option>Office</option>
      <option>Accounting</option>
    </select>

    <label>Звонки:</label>
    <input type="number" name="calls">

    <label>Встречи:</label>
    <input type="number" name="meetings">

    <label>Отправленные КП:</label>
    <input type="number" name="offers">

    <label>Сервисные выезды:</label>
    <input type="number" name="service_visits">

    <label>Выручка (AZN):</label>
    <input type="number" name="revenue">

    <label>Продажи ЗИП (AZN):</label>
    <input type="number" name="zip_sales">

    <label>Комментарий:</label>
    <textarea name="comment"></textarea>

    <button type="submit">Сохранить</button>
  </form>

  <p id="status" style="margin-top:10px;"></p>
</div>

<script>
document.getElementById('reportForm').addEventListener('submit', async function(e) {
  e.preventDefault();

  const data = Object.fromEntries(new FormData(this).entries());

  await fetch("https://script.google.com/macros/s/AKfycbzerEzgpGaHNJdbKCtUxGADu6VZmISCJui4RJeAsaDIndCYKKVg694l0lvv7ygouCWr/exec", {
    method: "POST",
    mode: "no-cors",
    body: JSON.stringify(data)
  });

  document.getElementById("status").innerHTML = "✔ Данные сохранены!";
  this.reset();
});
</script>

<style>
.kpi-container {
  max-width: 500px;
  padding: 20px;
  border-radius: 10px;
  background: #f4f7fb;
  font-family: Arial;
}
.kpi-container input, .kpi-container select, .kpi-container textarea {
  width: 100%;
  padding: 10px;
  margin-bottom: 10px;
}
.kpi-container button {
  background: #0057b7;
  color: #fff;
  padding: 10px;
  border: none;
  width: 100%;
  border-radius: 6px;
  cursor: pointer;
  font-size: 16px;
}
</style>
